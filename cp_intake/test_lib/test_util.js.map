{"version":3,"sources":["../test/test_util.js"],"names":[],"mappings":";;AAAA;;AAGA;;AAEA;;AAEA,SAAS,MAAT,EAAiB,YAAM;AACrB,oDAAkD,YAAM;AACtD,QAAI,cAAc,uBAAd,CADkD;AAEtD,QAAI,cAAc,oBAAS,WAAT,CAAd,CAFkD;;AAItD,8BAAe,WAAf,EAA4B,UAAS,GAAT,EAAc;AACxC,wBAAO,KAAK,KAAL,CAAW,GAAX,CAAP,EAAwB,EAAxB,CAA2B,GAA3B,CAA+B,KAA/B,CAAqC,KAArC,EADwC;KAAd,CAA5B,CAJsD;GAAN,CAAlD,CADqB;;AAUrB,iDAA+C,YAAM;AACnD,QAAI,2gCAAJ,CADmD;;AAInD,QAAI,cAAc,oBAAS,QAAT,CAAd,CAJ+C;;AAMnD,8BAAe,WAAf,EAA4B,UAAS,GAAT,EAAc;AACxC,UAAI,OAAO,EAAP,CADoC;AAExC,wBAAO,OAAO,KAAK,KAAL,CAAW,GAAX,CAAP,CAAP,CAA+B,EAA/B,CAAkC,GAAlC,CAAsC,KAAtC,CAA4C,KAA5C,EAFwC;KAAd,CAA5B,CANmD;GAAN,CAA/C,CAVqB;;AAsBrB,yDAAuD,YAAM;AAC3D,QAAI,2gCAAJ,CAD2D;;AAI3D,QAAI,cAAc,oBAAS,QAAT,CAAd,CAJuD;;AAM3D,8BAAe,WAAf,EAA4B,UAAS,GAAT,EAAc;AACxC,UAAI,OAAO,KAAK,KAAL,CAAW,GAAX,CAAP,CADoC;AAExC,wBAAO,IAAP,EAAa,EAAb,CAAgB,OAAhB,CAAwB,QAAxB,CAAiC,gBAAjC,EAFwC;KAAd,CAA5B,CAN2D;GAAN,CAAvD,CAtBqB;CAAN,CAAjB","file":"test_util.js","sourcesContent":["import { expect } from 'chai';\nimport { assert } from 'chai';\nimport { should } from 'chai';\nimport { parse_cp } from '../lib/util';\nimport { streamToString } from '../lib/util';\nimport { fake_cp } from '../lib/fake_cp';\n\ndescribe('util', () => {\n  it(`CP_Parser should transform CP Event to JSON`, () => {\n    let dummy_event = fake_cp();\n    let json_stream = parse_cp(dummy_event);\n\n    streamToString(json_stream, function(str) {\n      expect(JSON.parse(str)).to.not.throw(Error);\n    });\n  });\n\n  it(`CP_Parser should not error with bad data`, () => {\n    var bad_data =\n      `2014-07-14T21:38:52+0000 6Mar2014 14:07:24 redirect$ # ## % % # # @!1 ;;; / ;; 192.168.115.177 <eth1 alert web_client_type: Microsoft IE 8.0; ;;;; /// + 123 resource: http://leiw6.ayid.vnz/za/images/threatwiki/pages/TestAntiBotBlade.html;  ;;; # @ ! $ 5 7 , ; :src: 192.168.35.121; dst: 23.203.225.174; proto: tcp; session_id: {0x5318f19c,0x2,0xb17361d1,0xc0000000}; Protection name: Check Point - Testing Bot; malware_family: Check Point; Source OS: Windows; Confidence Level: 5; severity: 2; malware_action: Communication with C&C site; rule_uid: {49787C9F-D241-4E6B-91B3-402B56026391}; Protection Type: URL reputation; malware_rule_id: {0000000A-00BC-004E-9379-B356E398F290}; protection_id: 00233CFEE; refid: 0; log_id: 2; proxy_src_ip: 192.168.35.121; scope: 192.168.35.121; user: alice smith (alice)(+); src_user_name: alice smith (alice)(+); src_machine_name: xp1@opsec.com; snid: b7e71f09; product: Anti Malware; service: http; s_port: 3370; device_version: This is Check Points software version R77.10 - Build 243;`;\n\n    let json_stream = parse_cp(bad_data);\n\n    streamToString(json_stream, function(str) {\n      var json = {};\n      expect(json = JSON.parse(str)).to.not.throw(Error);\n    });\n  });\n\n  it(`CP_Parser should parse what it can with bad data`, () => {\n    var bad_data =\n      `2014-07-14T21:38:52+0000 6Mar2014 14:07:24 redirect$ # ## % % # # @!1 ;;; / ;; 192.168.115.177 <eth1 alert web_client_type: Microsoft IE 8.0; ;;;; /// + 123 resource: http://leiw6.ayid.vnz/za/images/threatwiki/pages/TestAntiBotBlade.html;  ;;; # @ ! $ 5 7 , ; :src: 192.168.35.121; dst: 23.203.225.174; proto: tcp; session_id: {0x5318f19c,0x2,0xb17361d1,0xc0000000}; Protection name: Check Point - Testing Bot; malware_family: Check Point; Source OS: Windows; Confidence Level: 5; severity: 2; malware_action: Communication with C&C site; rule_uid: {49787C9F-D241-4E6B-91B3-402B56026391}; Protection Type: URL reputation; malware_rule_id: {0000000A-00BC-004E-9379-B356E398F290}; protection_id: 00233CFEE; refid: 0; log_id: 2; proxy_src_ip: 192.168.35.121; scope: 192.168.35.121; user: alice smith (alice)(+); src_user_name: alice smith (alice)(+); src_machine_name: xp1@opsec.com; snid: b7e71f09; product: Anti Malware; service: http; s_port: 3370; device_version: This is Check Points software version R77.10 - Build 243;`;\n\n    let json_stream = parse_cp(bad_data);\n\n    streamToString(json_stream, function(str) {\n      var json = JSON.parse(str);\n      expect(json).to.contain.property('malware_family');\n    });\n  });\n});\n"]}